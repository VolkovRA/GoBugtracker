# Багтрекер для отправки сообщений на email

![](https://github.com/VolkovRA/GoBugtracker/blob/master/gopher_bug.png?raw=true)

### Зачем это надо
Позволяет любому клиентскому приложению отправить отчёт об ошибке с помощью простого и удобного REST API. Полученное сообщение будет переслано на указанный вами email в виде обычного письма.

### Описание
Этот сервис выступает в роли прокси, он просто пересылает все полученные сообщения на указанный вами email. Этот сервис больше ничего не делает!

Главные преимущества:
1. Максимально простой деплой, настройка и запуск.
2. Создание единой, простой точки для отправки отчётов всеми клиентами.
3. Возможность хранения отчётов об ошибках на почте.

Этот сервис упакован в  [Docker](https://www.docker.com/get-started) контейнер, благодаря чему его настройка и запуск элементарны. Вам нужно указать всего несколько переменных окружения и всё!
- `HOST` Адрес почтового сервера. (Например: `smtp.yandex.ru`)
- `PORT` Порт почтового сервера. (Например: `587`)
- `EMAIL` Ваш электронный ящик для складирования отчётов.
- `PSWD` Пароль от почтового ящика.

При необходимости подложить файлы сертификата для HTTPS соединения. После этого вы сможете отправлять отчёты об ошибках на свой электронный ящик с помощью удобного REST API.

### Использование
Вы можете скачать [готовый образ](https://hub.docker.com/r/rvolkov/bugtracker) из репозитория DockerHub:
```
docker pull rvolkov/bugtracker:latest
```
1. Для установки и запуска сервиса вам понадобится установить Docker на целевой хост.
2. Скачайте этот git репозиторий в любое удобное место.
3. Настройте переменные окружения в файле: `docker-compose.yml`.
4. Смонтируйте файлы сертификатов для вашего домена. *(По умолчанию используются тестовые)*

Команда для запуска:
```
docker-compose -f "docker-compose.yml" --project-name bugtracker up
```

### REST API
Для отправки отчёта об ошибке выполните обычный POST запрос в корень и передайте эти значения:
- `from` От кого это письмо. *(Пример: `MyGame android v1.0.0`)*
- `subject` Тема письма. *(Пример: `Purchase error` или `Uncaught error`)*
- `message` Текст сообщения. *(Стек вызова и т.п.)*

Ответ от API всегда приходит в формате JSON.  
Базовый ответ сервера:
```
{
    "success": false,
    "error": {
        "code": 1002,
        "message": "Требуется параметр: \"message\" для отправки сообщения. (Текст сообщения)"
    }
}
```
- `success` Результат выполнения запроса к API. *(Всегда есть в ответе)*
    * `true` - Сообщение отправлено, успешный запрос.
	* `false` - Сообщение не отправлено, сбой. В этом случае ответ будет содержать поле `error` с описанием причины.
- `error` Описание ошибки, если во время обращения к API что то пошло не так. *(Опционально)*

### Ошибки
Все ошибки жёстко стандартизированы:
```
"error": {
    "code": 404,
    "message": "Метод не найден"
}
```
- `code` Уникальный код ошибки, однозначно её идентифицирующий.
- `message` Текстовое описание.

| Код | Обозначение | Описание |
|:-|:-|:-|
|`400`|BadRequest|Некорректный запрос.|
|`404`|NotFound|Метод не найден.|
|`500`|InternalError|Внутренняя ошибка сервера.|
|`1000`|FromNeed|Требуется указать параметр: `from` для отправки сообщения. *(От какого приложения это сообщение)*|
|`1001`|SubjectNeed|Требуется указать параметр: `subject` для отправки сообщения. *(Тема сообщения, тип или класс ошибки)*|
|`1002`|MessageNeed|Требуется указать параметр: `message` для отправки сообщения. *(Текст сообщения)*|

### Разное
Почтовые сервера Яндекса: http://settings.su/yandex
